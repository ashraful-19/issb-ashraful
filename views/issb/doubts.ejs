

<%- include('../partials/header.ejs') %>

<section class="top-nav">
    <div><h4>Doubts</h4></div>
 <img src="https://th.bing.com/th/id/R.23ca2f3fbf7e19a1e85cd9d556d5ffaf?rik=uoFjTlg8g%2bIkqw&pid=ImgRaw&r=0" id="top-nav-icon-issb">
</section><br><br><br>
<style>


</style>



<div  id="slide-menu">
  <div class="item-menu active-doubts" data-category="ALL">ALL</div>
  <div class="item-menu" data-category="SSC">SSC</div>
  <div class="item-menu" data-category="HSC">HSC</div>
  <div class="item-menu" data-category="ADMISSION">ADMISSION</div>
  <div class="item-menu" data-category="ISSB">ISSB</div>
  <div class="item-menu" data-category="BCS">BCS</div>
</div>

<section class="questions-box">
  <% let counter = 1 %>
  <% data.forEach(function(exam) { %>
    <div class="qcontainer" data-category="<%= exam.exam_type %>" id="question<%= counter %>">
         <p>
            <span><b><%= counter %>)&nbsp;</b></span>
            <b><%- exam.question %></b>
         </p>
         <% let optionCounter = 1; %>
         
         <% exam.option.forEach((option, index) => { %>
         <div class="options">
             <input
                 type="radio"
                 id="option<%= optionCounter %><%= counter %>"
                 name="<%= exam._id %>"
                 value="<%= index + 1 %>"
                 <%= exam.your_answer === String(index + 1) ? 'checked' : 'disabled' %>
             />
             <label for="option<%= optionCounter %><%= counter %>"><%- option %></label>
         </div>
         <% optionCounter++; %>
         <% }) %>
         
      
        <div class="explainer">
<% if (data.show_explanation) { %>
          <div class="explain">
             <p>Explanation</p>
          </div>
          <% } %>

          <a class="love" href="/issb/verbal/<%= data.exam_code %>?id=<%= exam._id %>">
            <p><%= exam.doubts_count %></p>
            <i class="<%= exam.doubt == 0 ? 'fa-regular fa-heart' : 'fa-solid fa-heart' %>"></i>
         </a>
       </div>

       <% if (data.show_explanation) { %>
        <div class="explain-toggle-show">
          <p><%- exam.explanation %></p>
        </div>
      <% } %>
    </div>
    <% counter++ %>
  <% }) %>
 
</section>

<div id="no-data-found"> 
  <img width="200px" src="https://static.vecteezy.com/system/resources/previews/016/349/592/original/data-information-word-not-found-concept-illustration-flat-design-eps10-modern-graphic-element-for-landing-page-empty-state-ui-infographic-icon-vector.jpg" alt="">
  <h2>No Doubts found!</h2>
</div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const itemMenus = document.querySelectorAll('.item-menu');
    const questionContainers = document.querySelectorAll('.qcontainer');
    const noDataFound = document.getElementById('no-data-found');

    itemMenus.forEach(itemMenu => {
      itemMenu.addEventListener('click', function () {
        const selectedCategory = this.dataset.category;

        itemMenus.forEach(item => item.classList.remove('active-doubts'));
        this.classList.add('active-doubts');

        let found = false;

        questionContainers.forEach(container => {
          const containerCategory = container.dataset.category;

          if (selectedCategory === 'ALL' || selectedCategory === containerCategory) {
            container.style.display = 'block';
            found = true;
          } else {
            container.style.display = 'none';
          }
        });

        noDataFound.style.display = found ? 'none' : 'block';
      });
    });
  });
</script>


<div class="pagination">
  <% if (currentPage > 1) { %>
    <p><a href="/doubts?page=<%= currentPage - 1 %>">Prev</a></p>
  <% } %>
  
  <% for (let i = Math.max(currentPage - 5, 1); i <= Math.min(currentPage + 5, totalPages); i++) { %>
    <% if (i === currentPage) { %>
    <p class="pagination-active" ><span><%= i %></span></p>
    <% } else { %>
    <p><a href="/doubts?page=<%= i %>"><%= i %></a></p>
    <% } %>
  <% } %>
  
  <% if (currentPage < totalPages) { %>
  <p><a href="/doubts?page=<%= currentPage + 1 %>">Next</a></p>
  <% } %>
  </div>
  <br><br><br>



<div id="floatingMenu">
    <div class="">
        <div>
        <p><b>Questions Navigation</b></p>
        </div>
        <div class="easynav-float">
        
            <% for (var i = 1; i <= data.length; i++) { %>
                <p id="<%= i %>" class="scroll scroll<%= i %>"><%= i %></p>
            <% } %>
        </div>
    </div>
</div>

<div id="menuicon">
    <i class="fa-solid fa-list-ol"></i>
</div>


<!-- eye seciton -->
<div id="eye-open-close">
    <p>Show Explain </p>
    <i class="fa-solid fa-eye"></i>
    </div>




<!-- bottom nagivatoin section  -->


<%- include('../partials/bottom-nav.ejs') %>

</body>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
<script>
$(document).ready(function(){
$("#menuicon").click(function(){
$("#floatingMenu").fadeToggle(100);
});

$("#floatingMenu").click(function(event) {
event.stopPropagation();
});

$(document).mousedown(function(event) {
// Check if the clicked element is not a descendant of #floatingMenu or #menuicon
if (!$(event.target).is("#floatingMenu") && !$(event.target).is("#menuicon") && !$(event.target).parents("#floatingMenu").length) {
  $("#floatingMenu").fadeOut(500);
}
});
});

</script>

</html>
<script>





$(document).ready(function() {
// Scroll to section when a p tag is clicked
$(".scroll").click(function(event) {
event.preventDefault(); // prevent the default behavior of the click event
var id = $(this).attr("id"); // get the id of the clicked p tag

var section = $("#question" + id); // get the corresponding section using the id
var divPosition = $(section).offset().top;
$('html, body').animate({ scrollTop: divPosition - 250
}, 1000);
});
});


$(document).ready(function() {
$('.explain').click(function() {
$(this).closest('.qcontainer').find('.explain-toggle-hide').slideToggle();
});

});



// Get all radio buttons
const radioButtons = document.querySelectorAll('input[type="radio"]');

// Add event listener to each radio button
radioButtons.forEach(radio => {
radio.addEventListener('click', function() {
// Check if the radio button is checked
if (this.checked) {
  // Find the closest parent div with class "qcontainer"
  const qContainer = this.closest('.qcontainer');
  // Get the class ID from the qContainer
  const classId = qContainer.getAttribute('id');
  // Remove the "question" prefix from the class ID
  const questionId = classId.replace('question', '');
  // Find all p tags with the same class as the matching question
  const pTags = document.querySelectorAll(`.scroll${questionId}`);
  // Set the color of each p tag to red
  pTags.forEach(pTag => {
    pTag.style.background = 'rgb(171, 255, 219)';
  });
}
});
});




</script>
<script>
    





// Get all the radio buttons
const radioBtns = document.querySelectorAll('input[type="radio"]');

// Add event listener for each radio button
radioBtns.forEach(radioBtn => {
radioBtn.addEventListener('change', function() {
if (this.checked) {
  // Get the label element that is a sibling of this radio button
  const label = this.parentNode;
  
  // Get the parent label element of the sibling label
  const parentLabel = label.parentNode;
  
  // Add the "checked" class to the parent label
  parentLabel.classList.add('checked');
} else {
  // If the radio button is unchecked, remove the "checked" class from the parent label
  const label = this.parentNode;
  const parentLabel = label.parentNode;
  parentLabel.classList.remove('checked');
}
});
});




$(document).ready(function() {
  $('#eye-open-close').click(function() {
    $('.explain-toggle-hide').slideToggle();
    $(this).find('i').toggleClass('fa-eye-slash fa-eye');
    $(this).find('p').text(function(_, text) {
      return text === 'Hide Explain' ? 'Show Explain' : 'Hide Explain';
    });
  });
});


</script>
<script>
$(document).on('click', '.love', function(event) {
  event.preventDefault(); // prevent the default behavior of the link

  var form = $(this);
  var url = form.attr("href"); // add "/remove" to the end of the URL
  
  var icon = form.find('i'); // get the heart icon inside the clicked element
  var count = form.find('p'); // get the p tag inside the clicked element
  if (icon.hasClass('fa-solid')) { // if the icon is solid
    icon.removeClass('fa-solid').addClass('fa-regular'); // remove the solid class and add the regular class
    count.text(parseInt(count.text()) - 1); // decrement the doubts_count value by 1
  } else { // if the icon is regular
    icon.removeClass('fa-regular').addClass('fa-solid'); // remove the regular class and add the solid class
    count.text(parseInt(count.text()) + 1); // increment the doubts_count value by 1
  }
  icon.addClass('shake'); // add the shake class to the heart icon
  setTimeout(function() {
    icon.removeClass('shake'); // remove the shake class from the heart icon after 500ms
  }, 500);
  icon.addClass('wave'); // add the wave class to the heart icon
  setTimeout(function() {
    icon.removeClass('wave'); // remove the wave class from the heart icon after 800ms
  }, 800);

  let doubtsItems = form.closest('.qcontainer');
let pTag = document.createElement('p');
pTag.classList.add('deleted-doubts');
pTag.textContent = 'আমার প্রশ্নের উত্তর পেয়ে গেছি!';
doubtsItems.replaceWith(pTag);

// Add CSS transitions
pTag.style.opacity = 0;
pTag.style.transition = 'opacity 0.5s ease-in-out';

setTimeout(function() {
  pTag.style.opacity = 1;
}, 100);

setTimeout(function() {
  pTag.style.opacity = 0;
  setTimeout(function() {
    pTag.remove();
  }, 500);
}, 5000);


  $.ajax({
    type: "get",
    url: url,
    success: function(value) {
      console.log('data updated successfully');
    },
    error: function(error) {
      console.log(error);
    }
  });
});


</script>


