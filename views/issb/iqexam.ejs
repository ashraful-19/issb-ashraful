<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ISSB SCHOOL BANGLADESH</title>
    <link rel="stylesheet" href="/css/style.css" />

    <!-- Compiled and minified JavaScript -->

    <link
      href="https://fonts.maateen.me/solaiman-lipi/font.css"
      rel="stylesheet"
    />

    <!-- 9420 eii logota ekhn theke change korte hbe kaorn issb er logo  -->
    <link
      rel="shortcut icon"
      href="https://issb-bd.org/imgs/logonew.png"
      type="image/x-icon"
    />
    <!-- fontawesome link kora hoies kintu janina minified kina -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/regular.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.1/css/regular.min.css"
    />

	
  </head>



  <style>
    .loadbackground {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: #ffffff;
      z-index: 9999;
      display: none; /* add this line */
    }
    .load{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);
      /*change these sizes to fit into your project*/
      width:100px;
      height:100px;
    }
    .load hr{border:0;margin:0;width:40%;height:40%;position:absolute;border-radius:50%;animation:spin 2s ease infinite}
    
    .load :first-child{background:#19A68C;animation-delay:-1.5s}
    .load :nth-child(2){background:#F63D3A;animation-delay:-1s}
    .load :nth-child(3){background:#FDA543;animation-delay:-0.5s}
    .load :last-child{background:#193B48}
    
    @keyframes spin{
      0%,100%{transform:translate(0)}
      25%{transform:translate(160%)}
      50%{transform:translate(160%, 160%)}
      75%{transform:translate(0, 160%)}
    }
    
    #message {
			display: none;
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
      font-size: 15px;
			padding: 20px;
			background-color: #ffffff;box-shadow: rgba(0, 0, 0, 0.45) 0px 25px 20px -20px;
			color: #6851fd;
			text-align: center;
      border-bottom-right-radius: 10px;
      border-bottom-left-radius: 10px;
		}
    </style>
  <body><svg id="wave" style="transform:rotate(180deg); transition: 0.3s" viewBox="0 0 1440 330" version="1.1" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="sw-gradient-0" x1="0" x2="0" y1="1" y2="0"><stop stop-color="rgba(108, 1, 255, 1)" offset="0%"></stop><stop stop-color="rgba(32.058, 230.325, 189.351, 1)" offset="100%"></stop></linearGradient></defs><path style="transform:translate(0, 0px); opacity:1" fill="url(#sw-gradient-0)" d="M0,264L48,264C96,264,192,264,288,269.5C384,275,480,286,576,280.5C672,275,768,253,864,203.5C960,154,1056,77,1152,49.5C1248,22,1344,44,1440,93.5C1536,143,1632,220,1728,258.5C1824,297,1920,297,2016,286C2112,275,2208,253,2304,214.5C2400,176,2496,121,2592,88C2688,55,2784,44,2880,38.5C2976,33,3072,33,3168,44C3264,55,3360,77,3456,77C3552,77,3648,55,3744,66C3840,77,3936,121,4032,126.5C4128,132,4224,99,4320,110C4416,121,4512,176,4608,170.5C4704,165,4800,99,4896,110C4992,121,5088,209,5184,214.5C5280,220,5376,143,5472,143C5568,143,5664,220,5760,258.5C5856,297,5952,297,6048,269.5C6144,242,6240,187,6336,137.5C6432,88,6528,44,6624,66C6720,88,6816,176,6864,220L6912,264L6912,330L6864,330C6816,330,6720,330,6624,330C6528,330,6432,330,6336,330C6240,330,6144,330,6048,330C5952,330,5856,330,5760,330C5664,330,5568,330,5472,330C5376,330,5280,330,5184,330C5088,330,4992,330,4896,330C4800,330,4704,330,4608,330C4512,330,4416,330,4320,330C4224,330,4128,330,4032,330C3936,330,3840,330,3744,330C3648,330,3552,330,3456,330C3360,330,3264,330,3168,330C3072,330,2976,330,2880,330C2784,330,2688,330,2592,330C2496,330,2400,330,2304,330C2208,330,2112,330,2016,330C1920,330,1824,330,1728,330C1632,330,1536,330,1440,330C1344,330,1248,330,1152,330C1056,330,960,330,864,330C768,330,672,330,576,330C480,330,384,330,288,330C192,330,96,330,48,330L0,330Z"></path><defs><linearGradient id="sw-gradient-1" x1="0" x2="0" y1="1" y2="0"><stop stop-color="rgba(108, 1, 255, 1)" offset="0%"></stop><stop stop-color="rgba(49.1, 52.791, 116.486, 1)" offset="100%"></stop></linearGradient></defs><path style="transform:translate(0, 50px); opacity:0.9" fill="url(#sw-gradient-1)" d="M0,132L48,126.5C96,121,192,110,288,88C384,66,480,33,576,27.5C672,22,768,44,864,77C960,110,1056,154,1152,176C1248,198,1344,198,1440,214.5C1536,231,1632,264,1728,280.5C1824,297,1920,297,2016,269.5C2112,242,2208,187,2304,170.5C2400,154,2496,176,2592,176C2688,176,2784,154,2880,170.5C2976,187,3072,242,3168,242C3264,242,3360,187,3456,154C3552,121,3648,110,3744,88C3840,66,3936,33,4032,44C4128,55,4224,110,4320,110C4416,110,4512,55,4608,77C4704,99,4800,198,4896,231C4992,264,5088,231,5184,203.5C5280,176,5376,154,5472,126.5C5568,99,5664,66,5760,93.5C5856,121,5952,209,6048,214.5C6144,220,6240,143,6336,126.5C6432,110,6528,154,6624,143C6720,132,6816,66,6864,33L6912,0L6912,330L6864,330C6816,330,6720,330,6624,330C6528,330,6432,330,6336,330C6240,330,6144,330,6048,330C5952,330,5856,330,5760,330C5664,330,5568,330,5472,330C5376,330,5280,330,5184,330C5088,330,4992,330,4896,330C4800,330,4704,330,4608,330C4512,330,4416,330,4320,330C4224,330,4128,330,4032,330C3936,330,3840,330,3744,330C3648,330,3552,330,3456,330C3360,330,3264,330,3168,330C3072,330,2976,330,2880,330C2784,330,2688,330,2592,330C2496,330,2400,330,2304,330C2208,330,2112,330,2016,330C1920,330,1824,330,1728,330C1632,330,1536,330,1440,330C1344,330,1248,330,1152,330C1056,330,960,330,864,330C768,330,672,330,576,330C480,330,384,330,288,330C192,330,96,330,48,330L0,330Z"></path></svg>
	
    <div class="instruction">
		<h3><%= data.exam_name %></h3>
		<p>Total Questions-<%= data.questions.length %> || Marks-<%= data.questions.length %></p>
		<p>Duration-<%= data.time %>min</p>
	</div>	
	<section class="questions-box">
        <% let counter = 1 %>
        <form action="/issb/verbal/<%= data.exam_code %>/result" method="post" id="form-id">
            <% content.forEach(function(exam) { %>
            <div class="qcontainer" id="question<%= counter %>">
               <p>
                  <span><b><%= counter %>)&nbsp;</b></span>
                  <b><%= exam.question %></b>
               </p>
               <% if (exam.question_image && exam.question_image !== "") { %>
               <img class="q-image" src="<%= exam.question_image %>" alt="">
               <% } else { %>
               
               <% } %>
               <div class="options">  
                <input
                type="radio"
                name="<%= exam._id %>"
                value="1"
                id="option1<%= counter %>"            
              />
              <label for="option1<%= counter %>"><%= exam.choice1 %></label>
              </div>
              <div class="options">
              <input
                type="radio"
                id="option2<%= counter %>"
                name="<%= exam._id %>"
                value="2"
              />
              <label for="option2<%= counter %>"><%= exam.choice2 %></label>
             </div>
             <div class="options">
              
              <input
                type="radio"
                id="option3<%= counter %>"
                name="<%= exam._id %>"
                value="3"
              />
              <label for="option3<%= counter %>"><%= exam.choice3 %></label>
             </div>
              <div class="options">
              
              <input
                type="radio"
                id="option4<%= counter %>"
                name="<%= exam._id %>"
                value="4"
              />
              <label for="option4<%= counter %>"><%= exam.choice4 %></label>
             </div>
 
               <input
                  hidden
                  checked
                  type="radio"
                  name="<%= exam._id %>"
                  value="0"
                  />
               <div class="explainer">
                  <div class="explain">
                     <p>Explanation</p>
                  </div>
                  <a class="love" href="/issb/verbal/<%= data.exam_code %>?id=<%= exam._id %>">
                     <p><%= exam.doubts_count %></p>
                     <i class="<%= exam.doubt == 0 ? 'fa-regular fa-heart' : 'fa-solid fa-heart' %>"></i>
                  </a>
               </div>
               <div class="explain-toggle">
                  <p><%= exam.explanation %></p>
                  <% if (exam.explanation_image && exam.explanation_image !== "") { %>
                    <img class="e-image" src="<%= exam.explanation_image %>" alt="">
                    <% } else { %>
                    
                    <% } %>
               </div>
              
            </div>
            <% counter++ %>
            <% }) %>
            
			<button class="show-modal submitexam-demo" type="button">End Exam</button>

         </form>
				
	 
				
				<div class="qcontainer">
					<div>
					  <p><b>Questions Navigation</b></p>
					</div>
		  
					<div class="easynav">		
                        		  
						<% for (var i = 1; i <= data.questions.length; i++) { %>
                            <p id="<%= i %>" class="scroll scroll<%= i %>"><%= i %></p>
                        <% } %>
				</div>
       </div> 
				  <br />
			  
	</section>

	<div id="floatingMenu">
		<div class="">
			<div>
			<p><b>Questions Navigation</b></p>
			</div>
			<div class="easynav-float">
			
				<% for (var i = 1; i <= data.questions.length; i++) { %>
                    <p id="<%= i %>" class="scroll scroll<%= i %>"><%= i %></p>
                <% } %>
			</div>
			<br>
			<input type="submit" value="Submit Exam" class="submitexam">
		</div>
	</div>

    <div id="menuicon">
        <i class="fa-solid fa-list-ol"></i>
    </div>


<!-- stopwatch seciton -->
	<div class="timer">
		<span id="countdown"></span>
		<i class="fa-solid fa-stopwatch"></i>
	  </div>
	  

<!-- show modal -->
<div class="modal-mid">
    <div id="">
		<div class="">
			<div>
			<p><b>Questions Navigation</b></p>
			</div>
			<div class="easynav-float">
			
				<% for (var i = 1; i <= data.questions.length; i++) { %>
                    <p id="<%= i %>" class="scroll scroll<%= i %>"><%= i %></p>
                <% } %>
			</div>
			<br>
			<input type="submit" value="End Exam" class="submitexam show-modal">
		</div>
	</div>
</div>
<div class="loadbackground">
  <div class="load">
    <hr/><hr/><hr/><hr/>
  </div>
</div>


<!-- 1 min remaining message -->
<div id="message"> 
  <h2 style="color:black;">Reminder!</h2>
  <p>আপনার হাতে আর ১ মিনিট সময় আছে! যেসব  উত্তর করা হয়নি রিভিউ করে নিতে পারেন।</p>
</div>
 <!-- bottom nagivatoin section  -->


 <%- include('../partials/bottom-nav.ejs') %>

  </body>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>
  <script>
$(document).ready(function(){
  $("#menuicon").click(function(){
    $("#floatingMenu").fadeToggle(100);
  });

  $("#floatingMenu").click(function(event) {
    event.stopPropagation();
  });

  $(document).mousedown(function(event) {
    // Check if the clicked element is not a descendant of #floatingMenu or #menuicon
    if (!$(event.target).is("#floatingMenu") && !$(event.target).is("#menuicon") && !$(event.target).parents("#floatingMenu").length) {
      $("#floatingMenu").fadeOut(500);
    }
  });
});

</script>



	
  <script src="./script.js"></script>
 
</html>
<script>
let startingTime = 1.1;
    let time = startingTime * 60; //minutes * 60 seconds
    let refreshIntervalId = setInterval(updateCountdown, 1000); //update every 1 second
    
    function updateCountdown() {
      const minutes = Math.floor(time / 60); // rounds a number DOWN to the nearest integer
      let seconds = time % 60;
    
      seconds = seconds < 10 ? "0" + seconds : seconds;
      const contdownEl = document.getElementById("countdown");
      
      // Error handling
      if (!contdownEl) {
        console.error("countdown element not found");
        clearInterval(refreshIntervalId);
        return;
      }
    
      if (minutes >= 1) {
        contdownEl.innerHTML = `${minutes} min : ${seconds} sec`;
        contdownEl.value = time;
      } else {
        contdownEl.innerHTML = `${seconds} sec`;
        contdownEl.value = time;
      }
      time--;

      if(time == 60){
		    $('#message').slideDown();
		    setTimeout(function() {
			  $('#message').slideUp();
		    }, 10000);
      }
    
      if (time < 0) {
        //stop the setInterval when time = 0 for avoid negative time
        clearInterval(refreshIntervalId);
        contdownEl.value = time + 1;
        document.getElementById("form-id").submit();
        $('.loadbackground').fadeIn();
      }
    }

    
    const submitexams = document.querySelectorAll('.submitexam');
submitexams.forEach((submitexam) => {
  submitexam.addEventListener('click', (event) => {
    event.preventDefault();
    document.getElementById("form-id").submit();
    $('.loadbackground').fadeIn();

  });
});



    $(document).on('click', '.love', function(event) {
  event.preventDefault(); // prevent the default behavior of the link

  var form = $(this);
  var url = form.attr("href"); // add "/remove" to the end of the URL

  $.ajax({
    type: "get",
    url: url,
    success: function(value) {
      var icon = form.find('i'); // get the heart icon inside the clicked element
      var count = form.find('p'); // get the p tag inside the clicked element
      if (icon.hasClass('fa-solid')) { // if the icon is solid
        icon.removeClass('fa-solid').addClass('fa-regular'); // remove the solid class and add the regular class
        count.text(parseInt(count.text()) - 1); // decrement the doubts_count value by 1
      } else { // if the icon is regular
        icon.removeClass('fa-regular').addClass('fa-solid'); // remove the regular class and add the solid class
        count.text(parseInt(count.text()) + 1); // increment the doubts_count value by 1
      }
      icon.addClass('shake'); // add the shake class to the heart icon
      setTimeout(function() {
        icon.removeClass('shake'); // remove the shake class from the heart icon after 500ms
      }, 500);
      icon.addClass('wave'); // add the wave class to the heart icon
      setTimeout(function() {
        icon.removeClass('wave'); // remove the wave class from the heart icon after 800ms
      }, 800);
      console.log('data updated successfully');
    },
    error: function(error) {
      console.log(error);
    }
  });
});

$(document).ready(function() {
  // Scroll to section when a p tag is clicked
  $(".scroll").click(function(event) {
    event.preventDefault(); // prevent the default behavior of the click event
    var id = $(this).attr("id"); // get the id of the clicked p tag
    
    var section = $("#question" + id); // get the corresponding section using the id
    var divPosition = $(section).offset().top;
    $('html, body').animate({ scrollTop: divPosition - 250
    }, 1000);
  });
});


$(document).ready(function() {
    $('.explain').click(function() {
  $(this).closest('.qcontainer').find('.explain-toggle').slideToggle(200);
});


});



// Get all radio buttons
const radioButtons = document.querySelectorAll('input[type="radio"]');

// Add event listener to each radio button
radioButtons.forEach(radio => {
  radio.addEventListener('click', function() {
    // Check if the radio button is checked
    if (this.checked) {
      // Find the closest parent div with class "qcontainer"
      const qContainer = this.closest('.qcontainer');
      // Get the class ID from the qContainer
      const classId = qContainer.getAttribute('id');
      // Remove the "question" prefix from the class ID
      const questionId = classId.replace('question', '');
      // Find all p tags with the same class as the matching question
      const pTags = document.querySelectorAll(`.scroll${questionId}`);
      // Set the color of each p tag to red
      pTags.forEach(pTag => {
        pTag.style.background = 'rgb(171, 255, 219)';
      });
    }
  });
});




  </script>
<script>
    	
let modal = $('.modal-mid');
$('.show-modal').click(function() {
	let examCode = $(this).data('exam-code');
  modal.fadeToggle(100);
});

$(document).mousedown(function(event) {
  // Check if the target of the click event is not the modal element itself
  if (!$(event.target).closest(".modal-mid").length &&
      !$(event.target).is('.show-modal')) {
    modal.fadeOut(100);
  }
});





document.querySelector('#submit-button').addEventListener('click', function() {
			document.querySelector('.spinner').style.display = 'block';
			document.querySelector('#my-form').submit();
		});
</script>